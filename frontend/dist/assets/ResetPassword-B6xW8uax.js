import{u as g,e as j,r as n,j as e,m as y}from"./index-f8gYbhCl.js";import{a as N}from"./api-BYptnXG6.js";import{t as a}from"./index-Cne2OvF7.js";import{L as u}from"./lock-CswVYtIB.js";import{E as v,a as P}from"./eye-C1vUq6Vc.js";import"./index-Dgkh_OCz.js";function L(){const x=g(),[w]=j(),i=w.get("token"),[t,p]=n.useState({password:"",confirmPassword:""}),[r,f]=n.useState(!1),[d,c]=n.useState(!1),o=(s=>{if(!s)return{label:"",color:""};const l=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,b=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*?&]{6,}$/;return l.test(s)?{label:"Strong",color:"text-green-600"}:b.test(s)?{label:"Medium",color:"text-yellow-500"}:{label:"Weak",color:"text-red-500"}})(t.password),m=s=>{p({...t,[s.target.name]:s.target.value})},h=async s=>{if(s.preventDefault(),!i){a.error("Invalid or expired password reset link");return}if(t.password!==t.confirmPassword){a.error("Passwords do not match");return}c(!0);try{await N.post("/auth/reset-password",{token:i,newPassword:t.password}),a.success("Password reset successful! You can now log in."),x("/login")}catch(l){a.error(l?.response?.data?.message||"Password reset failed")}finally{c(!1)}};return e.jsx("div",{className:"min-h-screen flex flex-col justify-center items-center bg-gradient-to-br from-blue-50 via-white to-blue-100 p-4",children:e.jsxs(y.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6},className:"w-full max-w-md bg-white shadow-xl rounded-2xl p-8 border border-slate-100",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("img",{src:"/logo.png",alt:"Company Logo",className:"w-14 h-14"})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Reset Password"}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Enter your new password below to regain access"})]}),e.jsxs("form",{onSubmit:h,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"New Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(u,{className:"absolute left-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:r?"text":"password",name:"password",value:t.password,onChange:m,required:!0,placeholder:"Enter a new password",className:"w-full pl-10 pr-10 py-2 border rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 outline-none text-black"}),e.jsx("button",{type:"button",onClick:()=>f(s=>!s),className:"absolute right-3 top-2.5 text-slate-400",children:r?e.jsx(v,{size:20}):e.jsx(P,{size:20})})]}),o.label&&e.jsxs("p",{className:`text-xs mt-1 ${o.color}`,children:["Password strength: ",o.label]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Confirm New Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(u,{className:"absolute left-3 top-3 text-slate-400 w-5 h-5"}),e.jsx("input",{type:r?"text":"password",name:"confirmPassword",value:t.confirmPassword,onChange:m,required:!0,placeholder:"Re-enter new password",className:"w-full pl-10 pr-10 py-2 border rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 outline-none text-black"})]})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full bg-blue-600 text-white px-5 py-2 rounded-lg font-medium shadow hover:bg-blue-700 transition-colors disabled:opacity-50",children:d?"Resetting...":"Reset Password"})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-slate-500",children:["Remembered your password?"," ",e.jsx("a",{href:"/login",className:"text-blue-600 hover:underline font-medium",children:"Go to Login"})]})]})})}export{L as default};
