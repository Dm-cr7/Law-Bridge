import{r as h,u as Q,j as s,a as Z,U as ee,d as G}from"./index-DX-5XR_r.js";import{C as te}from"./clipboard-check-BzsqDZFf.js";import{T as ae}from"./triangle-alert-B4QflJIn.js";import{u as re,b as se,c as ie,i as p,r as ne,d as le,e as F,w as B,g as $,f as X,h as Y,j as R,s as L,k as oe,R as _,X as ce,Y as de,T as H,L as K,P as ue,a as he,C as xe}from"./PieChart-lom7UCbs.js";import{B as fe,a as W}from"./BarChart-DfyN2ysW.js";var me=["x1","y1","x2","y2","key"],ye=["offset"],ge=["xAxisId","yAxisId"],ve=["xAxisId","yAxisId"];function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?M(Object(a),!0).forEach(function(r){pe(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function pe(e,t,a){return(t=je(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function je(e){var t=be(e,"string");return typeof t=="symbol"?t:t+""}function be(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},j.apply(null,arguments)}function N(e,t){if(e==null)return{};var a,r,i=Ce(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Ce(e,t){if(e==null)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;a[r]=e[r]}return a}var Pe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:a,x:r,y:i,width:l,height:m,ry:d}=e;return h.createElement("rect",{x:r,y:i,ry:d,width:l,height:m,stroke:"none",fill:t,fillOpacity:a,className:"recharts-cartesian-grid-bg"})};function q(e,t){var a;if(h.isValidElement(e))a=h.cloneElement(e,t);else if(typeof e=="function")a=e(t);else{var{x1:r,y1:i,x2:l,y2:m,key:d}=t,f=N(t,me),o=oe(f),{offset:c}=o,n=N(o,ye);a=h.createElement("line",j({},n,{x1:r,y1:i,x2:l,y2:m,fill:"none",key:d}))}return a}function we(e){var{x:t,width:a,horizontal:r=!0,horizontalPoints:i}=e;if(!r||!i||!i.length)return null;var{xAxisId:l,yAxisId:m}=e,d=N(e,ge),f=i.map((o,c)=>{var n=x(x({},d),{},{x1:t,y1:o,x2:t+a,y2:o,key:"line-".concat(c),index:c});return q(r,n)});return h.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function Ae(e){var{y:t,height:a,vertical:r=!0,verticalPoints:i}=e;if(!r||!i||!i.length)return null;var{xAxisId:l,yAxisId:m}=e,d=N(e,ve),f=i.map((o,c)=>{var n=x(x({},d),{},{x1:o,y1:t,x2:o,y2:t+a,key:"line-".concat(c),index:c});return q(r,n)});return h.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function Oe(e){var{horizontalFill:t,fillOpacity:a,x:r,y:i,width:l,height:m,horizontalPoints:d,horizontal:f=!0}=e;if(!f||!t||!t.length)return null;var o=d.map(n=>Math.round(n+i-i)).sort((n,u)=>n-u);i!==o[0]&&o.unshift(0);var c=o.map((n,u)=>{var y=!o[u+1],g=y?i+m-n:o[u+1]-n;if(g<=0)return null;var v=u%t.length;return h.createElement("rect",{key:"react-".concat(u),y:n,x:r,height:g,width:l,stroke:"none",fill:t[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return h.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},c)}function ke(e){var{vertical:t=!0,verticalFill:a,fillOpacity:r,x:i,y:l,width:m,height:d,verticalPoints:f}=e;if(!t||!a||!a.length)return null;var o=f.map(n=>Math.round(n+i-i)).sort((n,u)=>n-u);i!==o[0]&&o.unshift(0);var c=o.map((n,u)=>{var y=!o[u+1],g=y?i+m-n:o[u+1]-n;if(g<=0)return null;var v=u%a.length;return h.createElement("rect",{key:"react-".concat(u),x:n,y:l,width:g,height:d,stroke:"none",fill:a[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return h.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},c)}var Ne=(e,t)=>{var{xAxis:a,width:r,height:i,offset:l}=e;return $(X(x(x(x({},R),a),{},{ticks:Y(a),viewBox:{x:0,y:0,width:r,height:i}})),l.left,l.left+l.width,t)},Se=(e,t)=>{var{yAxis:a,width:r,height:i,offset:l}=e;return $(X(x(x(x({},R),a),{},{ticks:Y(a),viewBox:{x:0,y:0,width:r,height:i}})),l.top,l.top+l.height,t)},Ee={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function J(e){var t=re(),a=se(),r=ie(),i=x(x({},ne(e,Ee)),{},{x:p(e.x)?e.x:r.left,y:p(e.y)?e.y:r.top,width:p(e.width)?e.width:r.width,height:p(e.height)?e.height:r.height}),{xAxisId:l,yAxisId:m,x:d,y:f,width:o,height:c,syncWithTicks:n,horizontalValues:u,verticalValues:y}=i,g=le(),v=F(S=>L(S,"xAxis",l,g)),b=F(S=>L(S,"yAxis",m,g));if(!p(o)||o<=0||!p(c)||c<=0||!p(d)||d!==+d||!p(f)||f!==+f)return null;var I=i.verticalCoordinatesGenerator||Ne,z=i.horizontalCoordinatesGenerator||Se,{horizontalPoints:C,verticalPoints:P}=i;if((!C||!C.length)&&typeof z=="function"){var T=u&&u.length,w=z({yAxis:b?x(x({},b),{},{ticks:T?u:b.ticks}):void 0,width:t,height:a,offset:r},T?!0:n);B(Array.isArray(w),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof w,"]")),Array.isArray(w)&&(C=w)}if((!P||!P.length)&&typeof I=="function"){var D=y&&y.length,A=I({xAxis:v?x(x({},v),{},{ticks:D?y:v.ticks}):void 0,width:t,height:a,offset:r},D?!0:n);B(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(P=A)}return h.createElement("g",{className:"recharts-cartesian-grid"},h.createElement(Pe,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),h.createElement(Oe,j({},i,{horizontalPoints:C})),h.createElement(ke,j({},i,{verticalPoints:P})),h.createElement(we,j({},i,{offset:r,horizontalPoints:C,xAxis:v,yAxis:b})),h.createElement(Ae,j({},i,{offset:r,verticalPoints:P,xAxis:v,yAxis:b})))}J.displayName="CartesianGrid";const V=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],E=({children:e,className:t=""})=>s.jsx("div",{className:`bg-white shadow-md rounded-xl p-5 border ${t}`,children:e}),O=({title:e,value:t,icon:a})=>s.jsxs(E,{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex items-center justify-center h-12 w-12 bg-blue-100 text-blue-600 rounded-lg",children:a}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:e}),s.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t??"â€”"})]})]}),k=()=>s.jsx("div",{className:"bg-gray-200 animate-pulse rounded-lg h-20"}),U=()=>s.jsx("div",{className:"bg-gray-200 animate-pulse rounded-lg h-72"});function Fe(){const[e,t]=h.useState(!0),[a,r]=h.useState(null),i=Q(),[l,m]=h.useState({totalCases:0,totalClients:0,openTasks:0,overdueTasks:0}),[d,f]=h.useState({monthlyCaseData:[],caseStatusData:[]});return h.useEffect(()=>{(async()=>{try{t(!0),r(null);const[c,n]=await Promise.all([G.get("/reports/summary?scope=self"),G.get("/reports/cases/summary?scope=self")]),u=c.data?.summary||{},y=n.data?.data||{};m({totalCases:y.total||0,totalClients:u.totalClients||0,openTasks:u.openTasks||0,overdueTasks:u.overdueTasks||0}),f({monthlyCaseData:y.byMonth||[],caseStatusData:y.byStatus?.map(g=>({name:g.status,value:g.count}))||[]})}catch(c){console.error("âŒ Analytics fetch error:",c);const n=c.response?.status;if(n===401){localStorage.removeItem("token"),i("/login");return}if(n===403){r("ðŸš« Access denied: insufficient permissions.");return}r(c.response?.data?.message||"Failed to load analytics data.")}finally{t(!1)}})()},[i]),a?s.jsxs("div",{className:"p-8 text-center text-red-600 font-medium",children:["âš ï¸ ",a]}):s.jsxs("div",{className:"p-8 bg-gray-50 min-h-screen text-gray-900",children:[s.jsxs("header",{className:"mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Analytics Overview"}),s.jsx("p",{className:"text-gray-500",children:"User-specific performance summary and case insights."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:e?s.jsxs(s.Fragment,{children:[s.jsx(k,{})," ",s.jsx(k,{})," ",s.jsx(k,{})," ",s.jsx(k,{})]}):s.jsxs(s.Fragment,{children:[s.jsx(O,{title:"Total Cases",value:l.totalCases,icon:s.jsx(Z,{size:24})}),s.jsx(O,{title:"Total Clients",value:l.totalClients,icon:s.jsx(ee,{size:24})}),s.jsx(O,{title:"Open Tasks",value:l.openTasks,icon:s.jsx(te,{size:24})}),s.jsx(O,{title:"Overdue Tasks",value:l.overdueTasks,icon:s.jsx(ae,{size:24})})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(E,{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"New vs Closed Cases (Monthly)"}),e?s.jsx(U,{}):d.monthlyCaseData.length>0?s.jsx(_,{width:"100%",height:300,children:s.jsxs(fe,{data:d.monthlyCaseData,children:[s.jsx(J,{strokeDasharray:"3 3",strokeOpacity:.2}),s.jsx(ce,{dataKey:"month"}),s.jsx(de,{}),s.jsx(H,{}),s.jsx(K,{}),s.jsx(W,{dataKey:"newCases",fill:"#3B82F6",name:"New Cases"}),s.jsx(W,{dataKey:"closedCases",fill:"#10B981",name:"Closed Cases"})]})}):s.jsx("div",{className:"text-gray-500 text-sm text-center py-10",children:"No monthly case data available."})]}),s.jsxs(E,{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Case Status Distribution"}),e?s.jsx(U,{}):d.caseStatusData.length>0?s.jsx(_,{width:"100%",height:300,children:s.jsxs(ue,{children:[s.jsx(he,{data:d.caseStatusData,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:({name:o,percent:c})=>`${o} ${(c*100).toFixed(0)}%`,children:d.caseStatusData.map((o,c)=>s.jsx(xe,{fill:V[c%V.length]},c))}),s.jsx(H,{}),s.jsx(K,{})]})}):s.jsx("div",{className:"text-gray-500 text-sm text-center py-10",children:"No case status data available."})]})]})]})}export{Fe as default};
