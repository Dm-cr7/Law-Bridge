import{f as N,u as b,r as l,d as p,j as e,m as w,M as k,B as g,L as c}from"./index-DX-5XR_r.js";import{n as t}from"./index-DFuZcw6R.js";import{R as C}from"./ResponsiveImage-B2MizuMw.js";import{C as R}from"./circle-check-big-CsO3dtKP.js";import{C as S}from"./circle-x-Dq1y862S.js";import{A as V}from"./arrow-right-C5Sqvr8h.js";import{R as L}from"./refresh-cw-Ckf3rgxU.js";function T(){const[f]=N(),d=f.get("token"),n=f.get("email")||"",y=b(),[a,r]=l.useState("idle"),[m,i]=l.useState(""),[h,u]=l.useState(!1),x=l.useCallback(async()=>{if(!d){r("error"),i("Verification token not found in URL.");return}try{r("pending"),i("");const s=await p.post("/auth/verify-email",{token:d},{withCredentials:!0});s?.data?.success||s?.status===200?(r("success"),i(s?.data?.message||"Your email has been verified. Thank you!"),t.success(s?.data?.message||"Email verified successfully")):(r("error"),i(s?.data?.message||"Verification failed. Please try again."),t.error(s?.data?.message||"Verification failed"))}catch(s){console.error("VerifyEmail error:",s);const o=s?.response?.data?.message||s?.response?.data?.error||s?.message||"Verification failed";r("error"),i(String(o)),t.error(String(o))}},[d]);l.useEffect(()=>{x()},[x]);const j=async()=>{if(!n){t.error("No email present to resend to. If you used a different link, enter your email on the reset page.");return}try{u(!0);const s=await p.post("/auth/resend-verification",{email:n},{withCredentials:!0});s?.data?.success?t.success(s.data.message||"Verification email resent."):t.error(s?.data?.message||"Failed to resend verification email.")}catch(s){console.error("Resend verification error:",s);const o=s?.response?.data?.message||s?.message||"Failed to resend";t.error(String(o))}finally{u(!1)}},v=()=>y("/login");return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-sky-50 via-blue-50 to-white text-slate-800",children:[e.jsxs("header",{className:"relative w-full h-56 sm:h-72 flex items-center justify-center overflow-hidden",children:[e.jsx(C,{src:"/images/legal-bg.jpg",alt:"Courtroom background",className:"absolute inset-0 w-full h-full object-cover opacity-80",style:{filter:"brightness(0.5) contrast(0.9)"}}),e.jsxs("div",{className:"relative z-10 text-center px-6",children:[e.jsx("img",{src:"/logo.png",alt:"LawBridge logo",className:"mx-auto w-28 h-auto mb-2"}),e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold text-white drop-shadow-md",children:"Verify your email"}),e.jsx("p",{className:"mt-2 text-sm md:text-base text-blue-50/90 max-w-2xl mx-auto",children:"Complete your registration — verify your email so you can access hearings, cases, and messages."})]})]}),e.jsx("main",{className:"flex-1 container py-12",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs(w.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-8 border border-slate-100",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:a==="success"?e.jsx(R,{className:"w-12 h-12 text-emerald-500"}):a==="pending"?e.jsx(k,{className:"w-12 h-12 text-sky-500 animate-pulse"}):e.jsx(S,{className:"w-12 h-12 text-rose-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold",children:a==="success"?"Email verified":a==="pending"?"Verifying your email...":"Verification failed"}),e.jsx("p",{className:"mt-2 text-slate-600",children:a==="pending"?"Please wait while we validate your verification link.":m||"If verification did not complete, you can try resending the email."}),a==="success"&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-3",children:[e.jsx(g,{onClick:v,className:"btn-primary",children:"Go to Login"}),e.jsxs(c,{to:"/dashboard",className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg border border-slate-200 hover:bg-slate-50",children:["Open Dashboard",e.jsx(V,{className:"w-4 h-4"})]})]}),a==="error"&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"If your link expired, you can request a new verification email."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(g,{onClick:j,className:"btn-primary",disabled:h,children:[h?"Sending...":"Resend verification",e.jsx(L,{className:"w-4 h-4 ml-2"})]}),e.jsx(g,{onClick:x,className:"btn-secondary",children:"Retry verification"}),e.jsx(c,{to:"/support",className:"text-sm text-slate-500 underline ml-1",children:"Contact support"})]}),n&&e.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Resending to: ",e.jsx("strong",{children:n})]})]})]})]}),m&&e.jsx("div",{className:"mt-6 bg-slate-50 border border-slate-100 rounded-md p-3 text-sm text-slate-700",children:m})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-slate-600",children:e.jsxs("div",{children:[e.jsx(c,{to:"/login",className:"underline mr-3",children:"Sign in"}),e.jsx(c,{to:"/register",className:"underline",children:"Create an account"})]})})]})}),e.jsxs("footer",{className:"py-8 text-center text-sm text-slate-500",children:["© ",new Date().getFullYear()," LawBridge — Building bridges in the legal world"]})]})}export{T as default};
