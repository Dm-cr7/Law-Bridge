import{r as a,j as s,z as w,B as o,U as B,F as K}from"./index-DX-5XR_r.js";import{a as y}from"./axiosInstance-QS7N9QFl.js";import{C as l,a as r,b as c,c as i}from"./Card-BJc8c6SY.js";import"./use-toast-BzRUQ8M6.js";import{R as D}from"./refresh-ccw-Dbz6RysH.js";import{D as g}from"./download-DmMTyFAX.js";import{S as F}from"./scale-Ujvrwy21.js";import{R as x,X as C,Y as v,T as h,L as P,P as $,a as I,C as M}from"./PieChart-lom7UCbs.js";import{L as W,a as k}from"./LineChart-BuC8iUXl.js";import{B as X,a as Y}from"./BarChart-DfyN2ysW.js";function ts(){const[q,m]=a.useState(!1),[t,R]=a.useState(null),[S,A]=a.useState([]),[j,E]=a.useState([]),[L,T]=a.useState([]),[p,f]=a.useState(!1),u=["#2563eb","#10b981","#f59e0b","#ef4444","#6b7280"];a.useEffect(()=>{b()},[]);const b=async()=>{try{m(!0);const{data:e}=await y.get("/api/reports/analytics");R(e.metrics),A(e.caseTrends),E(e.userStats),T(e.outcomes)}catch(e){console.error(e),toast({title:"Failed to load analytics",description:e.response?.data?.message||"Server unavailable",variant:"destructive"})}finally{m(!1)}},U=async()=>{f(!0),await b(),setTimeout(()=>f(!1),800)},N=async e=>{try{const n=await y.get(`/api/reports/export/${e}`,{responseType:"blob"}),O=new Blob([n.data]),d=document.createElement("a");d.href=URL.createObjectURL(O),d.download=`analytics_report.${e}`,d.click(),URL.revokeObjectURL(d.href)}catch{toast({title:"Export failed",variant:"destructive"})}};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h1",{className:"text-2xl font-semibold text-black-800 flex items-center gap-2",children:[s.jsx(w,{className:"w-6 h-6 text-blue-600"}),"System Analytics Dashboard"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(o,{onClick:U,disabled:p,children:[s.jsx(D,{className:`w-4 h-4 mr-1 ${p&&"animate-spin"}`}),"Refresh"]}),s.jsxs(o,{variant:"outline",onClick:()=>N("csv"),children:[s.jsx(g,{className:"w-4 h-4 mr-1"}),"Export CSV"]}),s.jsxs(o,{variant:"outline",onClick:()=>N("pdf"),children:[s.jsx(g,{className:"w-4 h-4 mr-1"}),"Export PDF"]})]})]}),t&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs(l,{className:"shadow",children:[s.jsxs(r,{className:"flex justify-between items-center",children:[s.jsx(c,{className:"text-black-600 text-sm",children:"Total Users"}),s.jsx(B,{className:"text-blue-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.totalUsers}),s.jsxs("p",{className:"text-sm text-black-500",children:["+",t.newUsers," this month"]})]})]}),s.jsxs(l,{className:"shadow",children:[s.jsxs(r,{className:"flex justify-between items-center",children:[s.jsx(c,{className:"text-black-600 text-sm",children:"Active Cases"}),s.jsx(F,{className:"text-green-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.activeCases}),s.jsxs("p",{className:"text-sm text-black-500",children:[t.closedCases," closed"]})]})]}),s.jsxs(l,{className:"shadow",children:[s.jsxs(r,{className:"flex justify-between items-center",children:[s.jsx(c,{className:"text-black-600 text-sm",children:"Evidence Files"}),s.jsx(K,{className:"text-amber-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.totalEvidence}),s.jsxs("p",{className:"text-sm text-black-500",children:[t.pendingEvidence," pending"]})]})]}),s.jsxs(l,{className:"shadow",children:[s.jsxs(r,{className:"flex justify-between items-center",children:[s.jsx(c,{className:"text-black-600 text-sm",children:"Awards Issued"}),s.jsx(w,{className:"text-purple-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.totalAwards}),s.jsxs("p",{className:"text-sm text-black-500",children:[t.newAwards," this quarter"]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(l,{className:"shadow",children:[s.jsx(r,{children:s.jsx(c,{children:"Case Trends (Past 12 Months)"})}),s.jsx(i,{children:s.jsx(x,{width:"100%",height:300,children:s.jsxs(W,{data:S,children:[s.jsx(C,{dataKey:"month",stroke:"#888"}),s.jsx(v,{}),s.jsx(h,{}),s.jsx(P,{}),s.jsx(k,{type:"monotone",dataKey:"cases",stroke:"#2563eb",strokeWidth:2}),s.jsx(k,{type:"monotone",dataKey:"closed",stroke:"#10b981",strokeWidth:2})]})})})]}),s.jsxs(l,{className:"shadow",children:[s.jsx(r,{children:s.jsx(c,{children:"User Distribution by Role"})}),s.jsx(i,{children:s.jsx(x,{width:"100%",height:300,children:s.jsxs($,{children:[s.jsx(I,{data:j,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"count",label:!0,children:j.map((e,n)=>s.jsx(M,{fill:u[n%u.length]},`cell-${n}`))}),s.jsx(h,{})]})})})]}),s.jsxs(l,{className:"shadow lg:col-span-2",children:[s.jsx(r,{children:s.jsx(c,{children:"Case Outcomes Overview"})}),s.jsx(i,{children:s.jsx(x,{width:"100%",height:300,children:s.jsxs(X,{data:L,children:[s.jsx(C,{dataKey:"type"}),s.jsx(v,{}),s.jsx(h,{}),s.jsx(Y,{dataKey:"count",fill:"#2563eb"})]})})})]})]})]})}export{ts as default};
