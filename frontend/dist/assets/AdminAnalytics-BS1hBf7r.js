import{c as B,r as a,j as s,B as d,U as K,F as D}from"./index-f8gYbhCl.js";import{a as N}from"./axiosInstance-CMvw4fUn.js";import{C as l,a as c,b as r,c as i}from"./Card-RIMQGzKH.js";import"./use-toast-BuzuOw6m.js";import{R as F}from"./refresh-ccw-ClALOjYv.js";import{D as w}from"./download-prd_qkFN.js";import{S as P}from"./scale-DLXVUIyX.js";import{R as x,X as g,Y as C,T as h,L as $,P as I,a as _,C as M}from"./PieChart-BHf6O0Tn.js";import{L as W,a as k}from"./LineChart-Gw1HkRV_.js";import{B as X,a as Y}from"./BarChart-CZeVbNpz.js";import"./index-Dgkh_OCz.js";/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],v=B("chart-no-axes-column",q);function cs(){const[H,m]=a.useState(!1),[t,R]=a.useState(null),[S,L]=a.useState([]),[j,A]=a.useState([]),[E,T]=a.useState([]),[p,f]=a.useState(!1),u=["#2563eb","#10b981","#f59e0b","#ef4444","#6b7280"];a.useEffect(()=>{b()},[]);const b=async()=>{try{m(!0);const{data:e}=await N.get("/api/reports/analytics");R(e.metrics),L(e.caseTrends),A(e.userStats),T(e.outcomes)}catch(e){console.error(e),toast({title:"Failed to load analytics",description:e.response?.data?.message||"Server unavailable",variant:"destructive"})}finally{m(!1)}},U=async()=>{f(!0),await b(),setTimeout(()=>f(!1),800)},y=async e=>{try{const n=await N.get(`/api/reports/export/${e}`,{responseType:"blob"}),O=new Blob([n.data]),o=document.createElement("a");o.href=URL.createObjectURL(O),o.download=`analytics_report.${e}`,o.click(),URL.revokeObjectURL(o.href)}catch{toast({title:"Export failed",variant:"destructive"})}};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h1",{className:"text-2xl font-semibold text-black-800 flex items-center gap-2",children:[s.jsx(v,{className:"w-6 h-6 text-blue-600"}),"System Analytics Dashboard"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(d,{onClick:U,disabled:p,children:[s.jsx(F,{className:`w-4 h-4 mr-1 ${p&&"animate-spin"}`}),"Refresh"]}),s.jsxs(d,{variant:"outline",onClick:()=>y("csv"),children:[s.jsx(w,{className:"w-4 h-4 mr-1"}),"Export CSV"]}),s.jsxs(d,{variant:"outline",onClick:()=>y("pdf"),children:[s.jsx(w,{className:"w-4 h-4 mr-1"}),"Export PDF"]})]})]}),t&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs(l,{className:"shadow",children:[s.jsxs(c,{className:"flex justify-between items-center",children:[s.jsx(r,{className:"text-black-600 text-sm",children:"Total Users"}),s.jsx(K,{className:"text-blue-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.totalUsers}),s.jsxs("p",{className:"text-sm text-black-500",children:["+",t.newUsers," this month"]})]})]}),s.jsxs(l,{className:"shadow",children:[s.jsxs(c,{className:"flex justify-between items-center",children:[s.jsx(r,{className:"text-black-600 text-sm",children:"Active Cases"}),s.jsx(P,{className:"text-green-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.activeCases}),s.jsxs("p",{className:"text-sm text-black-500",children:[t.closedCases," closed"]})]})]}),s.jsxs(l,{className:"shadow",children:[s.jsxs(c,{className:"flex justify-between items-center",children:[s.jsx(r,{className:"text-black-600 text-sm",children:"Evidence Files"}),s.jsx(D,{className:"text-amber-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.totalEvidence}),s.jsxs("p",{className:"text-sm text-black-500",children:[t.pendingEvidence," pending"]})]})]}),s.jsxs(l,{className:"shadow",children:[s.jsxs(c,{className:"flex justify-between items-center",children:[s.jsx(r,{className:"text-black-600 text-sm",children:"Awards Issued"}),s.jsx(v,{className:"text-purple-600 w-5 h-5"})]}),s.jsxs(i,{children:[s.jsx("p",{className:"text-2xl font-bold",children:t.totalAwards}),s.jsxs("p",{className:"text-sm text-black-500",children:[t.newAwards," this quarter"]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(l,{className:"shadow",children:[s.jsx(c,{children:s.jsx(r,{children:"Case Trends (Past 12 Months)"})}),s.jsx(i,{children:s.jsx(x,{width:"100%",height:300,children:s.jsxs(W,{data:S,children:[s.jsx(g,{dataKey:"month",stroke:"#888"}),s.jsx(C,{}),s.jsx(h,{}),s.jsx($,{}),s.jsx(k,{type:"monotone",dataKey:"cases",stroke:"#2563eb",strokeWidth:2}),s.jsx(k,{type:"monotone",dataKey:"closed",stroke:"#10b981",strokeWidth:2})]})})})]}),s.jsxs(l,{className:"shadow",children:[s.jsx(c,{children:s.jsx(r,{children:"User Distribution by Role"})}),s.jsx(i,{children:s.jsx(x,{width:"100%",height:300,children:s.jsxs(I,{children:[s.jsx(_,{data:j,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"count",label:!0,children:j.map((e,n)=>s.jsx(M,{fill:u[n%u.length]},`cell-${n}`))}),s.jsx(h,{})]})})})]}),s.jsxs(l,{className:"shadow lg:col-span-2",children:[s.jsx(c,{children:s.jsx(r,{children:"Case Outcomes Overview"})}),s.jsx(i,{children:s.jsx(x,{width:"100%",height:300,children:s.jsxs(X,{data:E,children:[s.jsx(g,{dataKey:"type"}),s.jsx(C,{}),s.jsx(h,{}),s.jsx(Y,{dataKey:"count",fill:"#2563eb"})]})})})]})]})]})}export{cs as default};
