import{r,j as e,F as $,B as n}from"./index-DX-5XR_r.js";import{a as g}from"./axiosInstance-QS7N9QFl.js";import{C as v,a as w,b as y,c as N}from"./Card-BJc8c6SY.js";import{I as h}from"./Input-BOJvGKkg.js";import{S as T,a as L,b as U,c as I,d as o}from"./Select-BN-5Xd7q.js";import"./use-toast-BzRUQ8M6.js";import{R as O}from"./refresh-ccw-Dbz6RysH.js";import{F as A}from"./file-spreadsheet-hyUXPshm.js";import{D as B}from"./download-DmMTyFAX.js";import{F as V}from"./funnel-Cy-HMMZ9.js";import{i as _}from"./format-FvBShcrJ.js";import"./chevron-down-DBqW3GSb.js";function Z(){const[S,j]=r.useState(!1),[l,C]=r.useState("arbitrations"),[i,k]=r.useState([]),[d,R]=r.useState(""),[x,D]=r.useState(""),[p,E]=r.useState(""),[f,u]=r.useState(!1),m=async()=>{try{j(!0);const s={};d&&(s.q=d),x&&(s.start=x),p&&(s.end=p);const{data:a}=await g.get(`/api/reports/${l}`,{params:s});k(a||[])}catch(s){console.error(s),toast({title:"Failed to load reports",description:s.response?.data?.message||"Server unavailable",variant:"destructive"})}finally{j(!1)}};r.useEffect(()=>{m()},[l]);const b=async s=>{try{const a=await g.get(`/api/reports/export/${l}.${s}`,{responseType:"blob"}),t=new Blob([a.data]),c=document.createElement("a");c.href=URL.createObjectURL(t),c.download=`${l}_report_${Date.now()}.${s}`,c.click(),URL.revokeObjectURL(c.href)}catch(a){toast({title:"Export failed",description:a.response?.data?.message||"Try again later",variant:"destructive"})}},F=async()=>{u(!0),await m(),setTimeout(()=>u(!1),800)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[e.jsxs("h1",{className:"text-2xl font-semibold text-black-800 flex items-center gap-2",children:[e.jsx($,{className:"text-blue-600 w-6 h-6"}),"Reports Center"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{onClick:F,disabled:f,children:[e.jsx(O,{className:`w-4 h-4 mr-1 ${f&&"animate-spin"}`}),"Refresh"]}),e.jsxs(n,{variant:"outline",onClick:()=>b("csv"),children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"Export CSV"]}),e.jsxs(n,{variant:"outline",onClick:()=>b("pdf"),children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Export PDF"]})]})]}),e.jsxs(v,{className:"shadow-sm",children:[e.jsx(w,{className:"flex justify-between items-center",children:e.jsxs(y,{className:"text-black-700 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-blue-600"})," Filters"]})}),e.jsxs(N,{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(T,{value:l,onValueChange:C,children:[e.jsx(L,{children:e.jsx(U,{placeholder:"Select report type"})}),e.jsxs(I,{children:[e.jsx(o,{value:"arbitrations",children:"Arbitrations"}),e.jsx(o,{value:"awards",children:"Awards"}),e.jsx(o,{value:"evidence",children:"Evidence"}),e.jsx(o,{value:"users",children:"Users"})]})]}),e.jsx(h,{placeholder:"Search keyword...",value:d,onChange:s=>R(s.target.value)}),e.jsx(h,{type:"date",value:x,onChange:s=>D(s.target.value)}),e.jsx(h,{type:"date",value:p,onChange:s=>E(s.target.value)}),e.jsx(n,{onClick:m,className:"md:col-span-4",children:"Apply Filters"})]})]}),e.jsxs(v,{className:"shadow",children:[e.jsx(w,{children:e.jsxs(y,{className:"text-black-700 capitalize",children:[l," Report"]})}),e.jsx(N,{children:S?e.jsx("p",{className:"text-center text-black-500",children:"Loading..."}):i.length===0?e.jsx("p",{className:"text-center text-black-400 italic",children:"No results found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-left border",children:[e.jsx("thead",{className:"bg-black-100 border-b",children:e.jsx("tr",{children:Object.keys(i[0]).map(s=>e.jsx("th",{className:"px-4 py-2 font-semibold capitalize",children:s.replace(/_/g," ")},s))})}),e.jsx("tbody",{children:i.map((s,a)=>e.jsx("tr",{className:`border-b hover:bg-black-50 transition ${a%2?"bg-black-50":"bg-white"}`,children:Object.values(s).map((t,c)=>e.jsx("td",{className:"px-4 py-2 text-black-700",children:t==null?"-":typeof t=="boolean"?t?"✅":"❌":t instanceof Date?_(new Date(t),"yyyy-MM-dd"):t.toString()},c))},a))})]})})})]})]})}export{Z as default};
