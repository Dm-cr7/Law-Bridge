import{c as g,b as N,r as c,j as e,d as m,m as h,f as v}from"./index-f8gYbhCl.js";import{t as i}from"./index-Cne2OvF7.js";import{a as p}from"./api-BYptnXG6.js";import{L as u}from"./lock-CswVYtIB.js";import{S as P}from"./save-CpWo0CdF.js";import"./index-Dgkh_OCz.js";/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],b=g("moon",S);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],z=g("settings-2",C);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],L=g("sun",M);function D(){const{user:U}=N(),[r,l]=c.useState(!1),[f,w]=c.useState(!0),[n,d]=c.useState({notifications:!0,emailUpdates:!0,theme:"light"}),[a,o]=c.useState({currentPassword:"",newPassword:"",confirmPassword:""});c.useEffect(()=>{(async()=>{try{const{data:t}=await p.get("/users/me/settings");d({notifications:t.notifications??!0,emailUpdates:t.emailUpdates??!0,theme:t.theme||"light"}),x(t.theme||"light")}catch{console.warn("No existing settings, using defaults")}finally{w(!1)}})()},[]);const x=s=>{const t=document.documentElement;s==="dark"?(t.classList.add("dark"),localStorage.setItem("theme","dark")):(t.classList.remove("dark"),localStorage.setItem("theme","light"))},y=()=>{const s=n.theme==="dark"?"light":"dark";d(t=>({...t,theme:s})),x(s)},k=async()=>{try{l(!0),await p.put("/users/me/settings",n),i.success("Settings updated successfully!")}catch(s){console.error("Save settings failed:",s),i.error("Failed to save settings")}finally{l(!1)}},j=async()=>{if(!a.currentPassword||!a.newPassword)return i.warning("Please fill out all password fields");if(a.newPassword!==a.confirmPassword)return i.error("New passwords do not match");try{l(!0),await p.put("/users/me/password",a),o({currentPassword:"",newPassword:"",confirmPassword:""}),i.success("Password updated successfully!")}catch(s){console.error("Password change failed:",s),i.error(s?.response?.data?.message||"Failed to change password")}finally{l(!1)}};return f?e.jsxs("div",{className:"flex justify-center items-center h-[70vh] text-slate-600",children:[e.jsx(m,{className:"animate-spin mr-2"})," Loading settings..."]}):e.jsx("div",{className:"settings-page min-h-screen bg-black-50 dark:bg-black-900 text-slate-900 dark:text-slate-100 py-10 px-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto bg-white dark:bg-black-800 shadow-md rounded-xl p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 dark:border-slate-700 pb-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400",children:e.jsx(z,{size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Settings"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Manage account preferences and appearance"})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(v,{size:18})," Notifications"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Email Updates"}),e.jsx("input",{type:"checkbox",checked:n.emailUpdates,onChange:s=>d(t=>({...t,emailUpdates:s.target.checked})),className:"h-4 w-4 accent-blue-600"})]}),e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"In-app Notifications"}),e.jsx("input",{type:"checkbox",checked:n.notifications,onChange:s=>d(t=>({...t,notifications:s.target.checked})),className:"h-4 w-4 accent-blue-600"})]})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(b,{size:18})," Appearance"]}),e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 dark:bg-black-700 rounded-lg p-3",children:[e.jsx("span",{children:n.theme==="dark"?"Dark mode is enabled":"Light mode is enabled"}),e.jsx("button",{onClick:y,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:n.theme==="dark"?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:16})," Light Mode"]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{size:16})," Dark Mode"]})})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},children:[e.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(u,{size:18})," Security"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsx("input",{type:"password",placeholder:"Current password",value:a.currentPassword,onChange:s=>o({...a,currentPassword:s.target.value}),className:"border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 bg-white dark:bg-black-800"}),e.jsx("input",{type:"password",placeholder:"New password",value:a.newPassword,onChange:s=>o({...a,newPassword:s.target.value}),className:"border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 bg-white dark:bg-black-800"}),e.jsx("input",{type:"password",placeholder:"Confirm new password",value:a.confirmPassword,onChange:s=>o({...a,confirmPassword:s.target.value}),className:"border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 bg-white dark:bg-black-800"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-6",children:[e.jsxs("button",{onClick:j,disabled:r,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md ${r?"bg-slate-400 cursor-not-allowed":"bg-amber-600 hover:bg-amber-700"} text-white`,children:[r?e.jsx(m,{className:"animate-spin",size:16}):e.jsx(u,{size:16}),"Change Password"]}),e.jsxs("button",{onClick:k,disabled:r,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md ${r?"bg-slate-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:[r?e.jsx(m,{className:"animate-spin",size:16}):e.jsx(P,{size:16}),"Save Preferences"]})]})]})]})})}export{D as default};
