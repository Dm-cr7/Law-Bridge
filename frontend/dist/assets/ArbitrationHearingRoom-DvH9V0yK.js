import{c as F,h as W,j as e,k as D,r as c,l as M,d as U,B as P,n as R}from"./index-f8gYbhCl.js";import{C as j,a as y,b as v,c as N}from"./Card-RIMQGzKH.js";import{I as z}from"./Input-syE1joBH.js";import{B as _,C as Y}from"./Badge-DCfLUgYb.js";import{n as k}from"./index-BggV2thh.js";import{U as V}from"./user-CmGx6MMi.js";/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],G=F("circle-stop",K);/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Q=F("send",J);var S={exports:{}},T,E;function X(){if(E)return T;E=1;var a="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return T=a,T}var C,A;function Z(){if(A)return C;A=1;var a=X();function l(){}function d(){}return d.resetWarningCache=l,C=function(){function s(x,g,w,p,f,o){if(o!==a){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}s.isRequired=s;function n(){return s}var i={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:n,element:s,elementType:s,instanceOf:n,node:s,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:d,resetWarningCache:l};return i.PropTypes=i,i},C}var I;function ee(){return I||(I=1,S.exports=Z()()),S.exports}var te=ee();const m=W(te),H=({children:a,className:l="",maxHeight:d="70vh",fadeTop:s=!1,fadeBottom:n=!1})=>e.jsxs("div",{className:"relative w-full",children:[s&&e.jsx("div",{className:"pointer-events-none absolute top-0 left-0 right-0 h-6 bg-gradient-to-b from-background to-transparent z-10"}),e.jsx("div",{className:`
          relative overflow-y-auto scrollbar-thin scrollbar-thumb-rounded-md
          scrollbar-thumb-black-400 hover:scrollbar-thumb-black-500
          dark:scrollbar-thumb-black-600 dark:hover:scrollbar-thumb-black-500
          ${l}
        `,style:{maxHeight:d},children:a}),n&&e.jsx("div",{className:"pointer-events-none absolute bottom-0 left-0 right-0 h-6 bg-gradient-to-t from-background to-transparent z-10"})]});H.propTypes={children:m.node.isRequired,className:m.string,maxHeight:m.string,fadeTop:m.bool,fadeBottom:m.bool};const O="/api",se="http://localhost:5000";function le(){const{id:a}=D(),[l,d]=c.useState(!0),[s,n]=c.useState(null),[i,x]=c.useState([]),[g,w]=c.useState([]),[p,f]=c.useState(""),[o,h]=c.useState(!1),[u,q]=c.useState(null),b=c.useRef(null);c.useEffect(()=>{(async()=>{try{const{data:r}=await R.get(`${O}/arbitrations/${a}`);n(r),w([r.claimant,r.respondent,r.arbitrator].filter(Boolean))}catch(r){console.error(r),k.error("Failed to load hearing info")}finally{d(!1)}})()},[a]),c.useEffect(()=>{try{const t=M(se,{query:{roomId:a},transports:["websocket"]});return t.on("connect",()=>{console.log("✅ Connected to hearing socket")}),t.on("chatMessage",r=>{x($=>[...$,r])}),t.on("hearingStatus",r=>{h(r==="active")}),t.on("disconnect",()=>{console.log("⚠️ Disconnected from hearing socket")}),q(t),()=>t.disconnect()}catch(t){console.warn("Socket.io not available:",t.message)}},[a]),c.useEffect(()=>{b.current&&b.current.scrollIntoView({behavior:"smooth"})},[i]);const B=()=>{if(!p.trim())return;const t={text:p,sender:"You",timestamp:new Date().toISOString()};x(r=>[...r,t]),u&&u.emit("chatMessage",t),f("")},L=async()=>{try{const t=o?"ended":"active";await R.patch(`${O}/arbitrations/${a}/hearing`,{status:t}),h(!o),u&&u.emit("hearingStatus",t),k.success(`Hearing ${o?"ended":"started"}`)}catch(t){console.error(t),k.error("Failed to update hearing status")}};return l?e.jsxs("div",{className:"flex h-80 items-center justify-center",children:[e.jsx(U,{className:"animate-spin mr-2"}),e.jsx("span",{children:"Loading hearing room..."})]}):s?e.jsxs("div",{className:"container mx-auto py-6 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(j,{className:"lg:col-span-1",children:[e.jsx(y,{children:e.jsx(v,{children:"Case Info"})}),e.jsxs(N,{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Title:"})," ",s.title]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx(_,{variant:o?"success":"secondary",className:"capitalize",children:o?"In Session":"Not Active"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Arbitrator:"})," ",s.arbitrator?.name||"Unassigned"]}),e.jsx("div",{className:"flex gap-2 mt-4",children:e.jsx(P,{onClick:L,variant:o?"destructive":"default",className:"flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4"})," End Hearing"]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4"})," Start Hearing"]})})})]})]}),e.jsxs(j,{children:[e.jsx(y,{children:e.jsx(v,{children:"Participants"})}),e.jsx(N,{children:g.length===0?e.jsx("p",{className:"text-black-500 text-sm",children:"No participants found."}):e.jsx("ul",{className:"divide-y divide-black-200",children:g.map(t=>e.jsxs("li",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-black-500"}),e.jsx("span",{children:t.name})]}),e.jsx(_,{variant:"outline",children:t.role||"Party"})]},t._id))})})]}),e.jsxs(j,{className:"lg:col-span-2",children:[e.jsx(y,{children:e.jsx(v,{children:"Hearing Chat"})}),e.jsxs(N,{children:[e.jsxs(H,{className:"h-64 border p-2 rounded-md mb-3",children:[i.length===0?e.jsx("p",{className:"text-black-500 text-sm",children:"No messages yet."}):i.map((t,r)=>e.jsxs("div",{className:`mb-2 ${t.sender==="You"?"text-right text-blue-600":"text-left text-black-800"}`,children:[e.jsx("span",{className:"block text-xs text-black-400",children:new Date(t.timestamp).toLocaleTimeString()}),e.jsxs("span",{className:"inline-block bg-black-100 rounded-lg px-3 py-1",children:[e.jsxs("strong",{children:[t.sender,": "]}),t.text]})]},r)),e.jsx("div",{ref:b})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{value:p,onChange:t=>f(t.target.value),placeholder:"Type a message...",disabled:!o}),e.jsx(P,{onClick:B,disabled:!o||!p,children:e.jsx(Q,{className:"h-4 w-4"})})]})]})]})]}):e.jsx("div",{className:"text-center text-black-500 mt-10",children:"⚠️ Arbitration not found."})}export{le as default};
