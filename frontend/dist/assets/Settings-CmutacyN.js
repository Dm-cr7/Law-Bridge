import{b as k,r as l,j as e,e as m,m as h,h as N,d as g,t as i}from"./index-DX-5XR_r.js";import{S as v,M as x,a as P}from"./sun-C_Mv-TbS.js";import{L as u}from"./lock-DTmp--nd.js";import{S}from"./save-efY_ys2Y.js";function M(){const{user:C}=k(),[r,d]=l.useState(!1),[b,f]=l.useState(!0),[n,c]=l.useState({notifications:!0,emailUpdates:!0,theme:"light"}),[t,o]=l.useState({currentPassword:"",newPassword:"",confirmPassword:""});l.useEffect(()=>{(async()=>{try{const{data:a}=await g.get("/users/me/settings");c({notifications:a.notifications??!0,emailUpdates:a.emailUpdates??!0,theme:a.theme||"light"}),p(a.theme||"light")}catch{console.warn("No existing settings, using defaults")}finally{f(!1)}})()},[]);const p=s=>{const a=document.documentElement;s==="dark"?(a.classList.add("dark"),localStorage.setItem("theme","dark")):(a.classList.remove("dark"),localStorage.setItem("theme","light"))},w=()=>{const s=n.theme==="dark"?"light":"dark";c(a=>({...a,theme:s})),p(s)},j=async()=>{try{d(!0),await g.put("/users/me/settings",n),i.success("Settings updated successfully!")}catch(s){console.error("Save settings failed:",s),i.error("Failed to save settings")}finally{d(!1)}},y=async()=>{if(!t.currentPassword||!t.newPassword)return i.warning("Please fill out all password fields");if(t.newPassword!==t.confirmPassword)return i.error("New passwords do not match");try{d(!0),await g.put("/users/me/password",t),o({currentPassword:"",newPassword:"",confirmPassword:""}),i.success("Password updated successfully!")}catch(s){console.error("Password change failed:",s),i.error(s?.response?.data?.message||"Failed to change password")}finally{d(!1)}};return b?e.jsxs("div",{className:"flex justify-center items-center h-[70vh] text-slate-600",children:[e.jsx(m,{className:"animate-spin mr-2"})," Loading settings..."]}):e.jsx("div",{className:"settings-page min-h-screen bg-black-50 dark:bg-black-900 text-slate-900 dark:text-slate-100 py-10 px-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto bg-white dark:bg-black-800 shadow-md rounded-xl p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-200 dark:border-slate-700 pb-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400",children:e.jsx(v,{size:28})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Settings"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Manage account preferences and appearance"})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(N,{size:18})," Notifications"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Email Updates"}),e.jsx("input",{type:"checkbox",checked:n.emailUpdates,onChange:s=>c(a=>({...a,emailUpdates:s.target.checked})),className:"h-4 w-4 accent-blue-600"})]}),e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"In-app Notifications"}),e.jsx("input",{type:"checkbox",checked:n.notifications,onChange:s=>c(a=>({...a,notifications:s.target.checked})),className:"h-4 w-4 accent-blue-600"})]})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(x,{size:18})," Appearance"]}),e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 dark:bg-black-700 rounded-lg p-3",children:[e.jsx("span",{children:n.theme==="dark"?"Dark mode is enabled":"Light mode is enabled"}),e.jsx("button",{onClick:w,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:n.theme==="dark"?e.jsxs(e.Fragment,{children:[e.jsx(P,{size:16})," Light Mode"]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{size:16})," Dark Mode"]})})]})]}),e.jsxs(h.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},children:[e.jsxs("h2",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(u,{size:18})," Security"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsx("input",{type:"password",placeholder:"Current password",value:t.currentPassword,onChange:s=>o({...t,currentPassword:s.target.value}),className:"border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 bg-white dark:bg-black-800"}),e.jsx("input",{type:"password",placeholder:"New password",value:t.newPassword,onChange:s=>o({...t,newPassword:s.target.value}),className:"border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 bg-white dark:bg-black-800"}),e.jsx("input",{type:"password",placeholder:"Confirm new password",value:t.confirmPassword,onChange:s=>o({...t,confirmPassword:s.target.value}),className:"border border-slate-300 dark:border-slate-600 rounded-md px-3 py-2 bg-white dark:bg-black-800"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-6",children:[e.jsxs("button",{onClick:y,disabled:r,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md ${r?"bg-slate-400 cursor-not-allowed":"bg-amber-600 hover:bg-amber-700"} text-white`,children:[r?e.jsx(m,{className:"animate-spin",size:16}):e.jsx(u,{size:16}),"Change Password"]}),e.jsxs("button",{onClick:j,disabled:r,className:`inline-flex items-center gap-2 px-5 py-2 rounded-md ${r?"bg-slate-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:[r?e.jsx(m,{className:"animate-spin",size:16}):e.jsx(S,{size:16}),"Save Preferences"]})]})]})]})})}export{M as default};
