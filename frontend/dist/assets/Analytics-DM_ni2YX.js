import{c as A,r as n,u as B,j as e,a as R,U as F}from"./index-f8gYbhCl.js";import{a as p}from"./api-BYptnXG6.js";import{T as P}from"./triangle-alert-BTqnxZkX.js";import{R as g,X as E,Y as O,T as b,L as f,P as k,a as C,C as N}from"./PieChart-BHf6O0Tn.js";import{B as K,a as S}from"./BarChart-CZeVbNpz.js";import{C as L}from"./CartesianGrid-B7X0XMzY.js";import"./index-Dgkh_OCz.js";/**
 * @license lucide-react v0.534.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],z=A("clipboard-check",$),x=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],u=({children:s,className:l=""})=>e.jsx("div",{className:`bg-white shadow-md rounded-xl p-5 border border-black-100 ${l}`,children:s}),m=({title:s,value:l,icon:o})=>e.jsxs(u,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center h-12 w-12 bg-blue-100 text-blue-600 rounded-lg",children:o}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-black-500",children:s}),e.jsx("p",{className:"text-2xl font-semibold text-black",children:l??"â€”"})]})]}),h=()=>e.jsx("div",{className:"bg-black-200 animate-pulse rounded-lg h-20"}),y=()=>e.jsx("div",{className:"bg-black-200 animate-pulse rounded-lg h-72"});function q(){const[s,l]=n.useState(!0),[o,j]=n.useState(null),v=B(),[d,T]=n.useState({totalCases:0,totalClients:0,openTasks:0,overdueTasks:0}),[t,w]=n.useState({monthlyCaseData:[],caseStatusData:[],adrPerformance:[]});return n.useEffect(()=>{(async()=>{try{l(!0),j(null);const[a,i,D]=await Promise.all([p.get("/reports/summary"),p.get("/reports/cases/summary"),p.get("/reports/adr/success")]);T({totalCases:i.data?.data?.total||0,totalClients:a.data?.summary?.totalClients||0,openTasks:a.data?.summary?.openTasks||0,overdueTasks:a.data?.summary?.overdueTasks||0}),w({monthlyCaseData:i.data?.data?.byMonth||[],caseStatusData:i.data?.data?.byStatus?.map(c=>({name:c.status,value:c.count}))||[],adrPerformance:D.data?.data?.breakdown?.map(c=>({name:c._id,value:c.count}))||[]})}catch(a){console.error("âŒ Analytics fetch error:",a);const i=a.response?.status;if(i===401){localStorage.removeItem("token"),v("/login");return}if(i===403){j("ðŸš« Access denied: insufficient permissions.");return}j(a.response?.data?.message||"Failed to load analytics data.")}finally{l(!1)}})()},[v]),o?e.jsxs("div",{className:"p-8 text-center text-red-600 font-medium",children:["âš ï¸ Error: ",o]}):e.jsxs("div",{className:"p-8 bg-black-50 min-h-screen text-black",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Analytics Overview"}),e.jsx("p",{className:"text-black-500",children:"Visual insights into firm-wide and user-specific performance."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:s?e.jsxs(e.Fragment,{children:[e.jsx(h,{})," ",e.jsx(h,{})," ",e.jsx(h,{})," ",e.jsx(h,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{title:"Total Cases",value:d.totalCases,icon:e.jsx(R,{size:24})}),e.jsx(m,{title:"Total Clients",value:d.totalClients,icon:e.jsx(F,{size:24})}),e.jsx(m,{title:"Open Tasks",value:d.openTasks,icon:e.jsx(z,{size:24})}),e.jsx(m,{title:"Overdue Tasks",value:d.overdueTasks,icon:e.jsx(P,{size:24})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(u,{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 text-black",children:"New vs. Closed Cases (Monthly)"}),s?e.jsx(y,{}):t.monthlyCaseData.length>0?e.jsx(g,{width:"100%",height:300,children:e.jsxs(K,{data:t.monthlyCaseData,children:[e.jsx(L,{strokeDasharray:"3 3",strokeOpacity:.2}),e.jsx(E,{dataKey:"month"}),e.jsx(O,{}),e.jsx(b,{}),e.jsx(f,{}),e.jsx(S,{dataKey:"newCases",fill:"#3B82F6",name:"New Cases"}),e.jsx(S,{dataKey:"closedCases",fill:"#10B981",name:"Closed Cases"})]})}):e.jsx("div",{className:"text-black-500 text-sm text-center py-10",children:"No monthly case data available"})]}),e.jsxs(u,{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 text-black",children:"Case Status Distribution"}),s?e.jsx(y,{}):t.caseStatusData.length>0?e.jsx(g,{width:"100%",height:300,children:e.jsxs(k,{children:[e.jsx(C,{data:t.caseStatusData,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:({name:r,percent:a})=>`${r} ${(a*100).toFixed(0)}%`,children:t.caseStatusData.map((r,a)=>e.jsx(N,{fill:x[a%x.length]},a))}),e.jsx(b,{}),e.jsx(f,{})]})}):e.jsx("div",{className:"text-black-500 text-sm text-center py-10",children:"No case data available"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(u,{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 text-black",children:"ADR Success Breakdown"}),s?e.jsx(y,{}):t.adrPerformance.length>0?e.jsx(g,{width:"100%",height:300,children:e.jsxs(k,{children:[e.jsx(C,{data:t.adrPerformance,cx:"50%",cy:"50%",outerRadius:120,dataKey:"value",label:({name:r,percent:a})=>`${r} ${(a*100).toFixed(0)}%`,children:t.adrPerformance.map((r,a)=>e.jsx(N,{fill:x[a%x.length]},a))}),e.jsx(b,{}),e.jsx(f,{})]})}):e.jsx("div",{className:"text-black-500 text-sm text-center py-10",children:"No ADR data available"})]})})]})}export{q as default};
